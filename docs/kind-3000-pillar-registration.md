# Kind 3000: Pillar Registration

| Property | Value |
| --- | --- |
| Kind Number | 3000 |
| Event Range | Regular (non-replaceable) |
| Status | Draft |
| Depends on | [NIP-01](https://github.com/nostr-protocol/nips/blob/master/01.md), [NIP-31](https://github.com/nostr-protocol/nips/blob/master/31.md), [NIP-73](https://github.com/nostr-protocol/nips/blob/master/73.md) |

This document specifies a Nostr event for binding a Pillar's public key to a Nostr public key (`npub`) within the HyperCore One Incubator ecosystem. This creates a verifiable link between a Pillar's on-chain identity and a Nostr public key.

This is a **regular, non-replaceable event**. A full history of registration events is maintained to provide an audit trail. Updates are managed via a sequentially increasing `sequence`.

This specification incorporates [NIP-73](https://github.com/nostr-protocol/nips/blob/master/73.md) for discoverability of events associated with the Pillar's on-chain address.

## Content Format

The `content` field **MUST** be empty.

### Schema

```json
"content": ""
```

## Event Structure

```json
{
  "id": "<32-bytes lowercase hex-encoded sha256 of the serialized event data>",
  "pubkey": "<32-bytes lowercase hex-encoded public key of the event creator>",
  "created_at": <unix_timestamp>,
  "kind": 3000,
  "tags": [
    ["pillar", "<on-chain pillar moniker>"],
    ["sequence", "<sequential number as string>"],
    ["pillar_pubkey", "<64-character Ed25519 public key in lowercase hexadecimal>"],
    ["pillar_sig", "<128-character Ed25519 signature in lowercase hexadecimal>"],
    ["i", "<network>[:<chainId, integer>]:address:<pillar_bech32_address>"],
    ["k", "<network>:address"],
    ["e", "<previous pillar-registration event id>"],
    ["alt", "<human-readable event description>"]
  ],
  "content": "",
  "sig": "<64-bytes lowercase hex of the signature of the sha256 hash of the serialized event data, which is the same as the 'id' field>"
}
```

## Tags

| Tag Name | Description | Example Format | Required |
|----------|-------------|----------------|---------|
| `pillar` | Pillar's registered name | `["pillar", "PillarOne"]` | Yes |
| `sequence` | Sequential number for updates | `["sequence", "1"]` | Yes |
| `pillar_pubkey` | Pillar's Ed25519 public key used for verification | `["pillar_pubkey", "aabbccddeeff00112233445566778899aabbccddeeff00112233445566778899"]` | Yes |
| `pillar_sig` | Pillar's Ed25519 signature over the canonical message | `["pillar_sig", "ea00f1ab2ad34b60080e77b431d806e9ead4a4eee36e41cf58a05859b080a03a4dc8a8b21b4952dacf5f7f97262ffdcde47132a269ca97c69260543cd0dc8604"]` | Yes |
| `i` | NIP-73 pillar address identifier | `["i", "zenon:1:address:z1qqjnwjjpnue8xmmpanz6csze6tcmtzzdtfsww7"]` | Yes |
| `k` | NIP-73 identifier type | `["k", "zenon:address"]` | Recommended |
| `e` | Previous pillar registration event id (for updates) | `["e", "<event_id>"]` | Optional |
| `alt` | Human-readable event description | `["alt", "Registration for PillarOne on HC1 Incubator"]` | Recommended |

### `pillar`
 The unique identifier for the Pillar, which is its registered name on the Zenon Network.
 
 Example: `["pillar", "PillarOne"]`
 
 Note: This tag is informational and MAY be omitted. Clients MUST NOT enforce uniqueness or rely on it for identity, deduplication, or record selection. For a verified name, resolve it from the on-chain name assigned to the address in the `i` tag in the Zenon Network; if it matches the tag value you MAY display a verified indicator.

### `sequence`
 A sequential integer (as a string) used for versioning. When multiple registration events exist for the same Pillar, the one with the highest `sequence` is considered the most recent. Events with a lower number MUST be ignored.

Example: `["sequence", "1"]`

### `pillar_pubkey`
The Pillar's Ed25519 registered public key on Zenon Network. This key is used to verify `pillar_sig`.

Example: `["pillar_pubkey", "aabbccddeeff00112233445566778899aabbccddeeff00112233445566778899"]`

### `pillar_sig`
The Ed25519 signature generated by the private key corresponding to `pillar_pubkey`. This proves control of the pillar key over the canonical signature message defined below.

Example: `["pillar_sig", "ea00f1ab2ad34b60080e77b431d806e9ead4a4eee36e41cf58a05859b080a03a4dc8a8b21b4952dacf5f7f97262ffdcde47132a269ca97c69260543cd0dc8604"]`

### `i` and `k` (NIP-73)

These tags make the event discoverable by NIP-73 compatible clients. The `i` tag contains the Pillar's on-chain address, and the `k` tag specifies the type of identifier. The chainId component in the `i` tag is optional.

- `i`: `["i", "zenon:1:address:<pillar_bech32_address>"]`
- `k`: `["k", "zenon:address"]`

Example: `["i", "zenon:address:z1qqjnwjjpnue8xmmpanz6csze6tcmtzzdtfsww7"]`, `["k", "zenon:address"]`

### `alt`
A human-readable summary of the event's purpose, as per [NIP-31](https://github.com/nostr-protocol/nips/blob/master/31.md). The `content` field **MUST** be empty.

Example: `["alt", "Registration for PillarOne on HC1 Incubator"]`

### `e` (previous event link)
The id of the previous pillar registration event for the same pillar/address, used to form a verifiable chain of updates. Omit on the first registration.

Example: `["e", "4376c65d2f232afbe9b882a35baa4f6fe8667c4e684749af565f981833ed6a65"]`

## Canonical Signature Message

To prevent replay across contexts and to ensure wallet compatibility, the external signature MUST be produced over the following canonical, single-line UTF-8 string constructed from the event fields and tags exactly as published, joined with the `|` character in this exact order:

```
hc1:registration|kind=3000|i=<value of i tag>|k=<value of k tag>|nostr_pubkey=<event.pubkey, lowercase hex>|sequence=<value of sequence tag>|created_at=<event.created_at>
```

Normalization rules:
- Use lowercase hex for all hex fields, no `0x` prefixes.
- Single line only: no newlines, carriage returns, tabs, or spaces anywhere.
- Use the ASCII `|` character as the field separator, with no leading/trailing separator.
- Fields MUST appear in exactly the order shown above and be unquoted.
- Use the tag values exactly as serialized in the event (no re-encoding or normalization beyond the rules above).

## Client Behavior

To accept a Pillar Registration, clients MUST:

1. Identifier and address
   - Require `k == "zenon:address"` and `i` to be a valid Zenon bech32 address.
   - Verify the `i` address matches `pillar_pubkey` (Address Verification).

2. Author binding
   - Ensure `event.pubkey` is the npub being registered (or equals the expected npub).

3. Canonical Signature Message
   - Construct the single-line message exactly as specified in [“Canonical Signature Message”](#canonical-signature-message).

4. External signature
   - Verify `pillar_sig` (Ed25519) over the Canonical Signature Message using `pillar_pubkey`.

5. Selection
   - Per `i`/`k`, select the event with the highest `sequence`.
   - If tied, prefer greater `created_at`; if still tied, prefer the lexicographically lowest `id`.

## Relay Behavior

Relays SHOULD treat Kind 3000 events as regular events and are not required to perform any special validation beyond standard Nostr event validation. Relays MAY choose to implement additional filtering or validation policies at their discretion.

## Example Event

```json
{
  "id": "4376c65d2f232afbe9b882a35baa4f6fe8667c4e684749af565f981833ed6a65",
  "pubkey": "6e468422dfb74a5738702a8823b9b28168abab8655faacb6853cd0ee15deee93",
  "created_at": 1671217411,
  "kind": 3000,
  "tags": [
    ["pillar", "PillarOne"],
    ["sequence", "1"],
    ["pillar_pubkey", "aabbccddeeff00112233445566778899aabbccddeeff00112233445566778899"],
    ["pillar_sig", "ea00f1ab2ad34b60080e77b431d806e9ead4a4eee36e41cf58a05859b080a03a4dc8a8b21b4952dacf5f7f97262ffdcde47132a269ca97c69260543cd0dc8604"],
    ["i", "zenon:1:address:z1qqjnwjjpnue8xmmpanz6csze6tcmtzzdtfsww7"],
    ["k", "zenon:address"],
    ["alt", "Registration for PillarOne on HC1 Incubator"]
  ],
  "content": "",
  "sig": "908a15e46fb4d8675bab026fc230a0e3542bfade63da02d542fb78b2a8513fcd0092619a2c8c1221e581946e0191f2af505dfdf8657a414dbca329186f009262"
}
```
